#N canvas 188 132 994 659 10;
#X text 338 54 downsampler: takes the last n samples of an incoming
signal;
#X text 338 72 and outputs their average as a steady value;
#N canvas 557 197 450 278 (subpatch) 0;
#X array \$0-triggerTab 1 float 2;
#X coords 0 278 1 277 200 140 0;
#X restore 445 576 graph;
#X obj 157 238 tabread~ \$0-triggerTab;
#X obj 157 192 phasor~;
#X obj 157 214 *~;
#X text 547 266 freq (Hz) for the phasor;
#X text 15 275 incoming signal;
#X obj 453 263 expr $f2 / $f1;
#X text 367 176 number of samples to average together;
#X obj 473 290 array size \$0-triggerTab;
#X text 625 290 resizes array;
#X obj 440 471 loadbang;
#X obj 440 538 array set \$0-triggerTab;
#X obj 440 493 t b b;
#X msg 440 515 1;
#X msg 507 515 0;
#X text 526 494 initializes the trigger array;
#X obj 534 217 loadbang;
#X obj 534 239 samplerate~;
#X text 608 240 current sample rate;
#X obj 45 342 fexpr~ if($x2 == 0 \, $x1 + $y[-1] \, $x3);
#X obj 44 472 /~;
#X text 485 576 \$0-triggerTab array is stored here;
#X obj 45 387 fexpr~ if($x2 == 1 \, $x1 \, $y[-1]);
#X obj 157 295 fexpr~ $x1[-1];
#X text 256 294 delays by one sample;
#X text 283 335 keeps a running total of samples fed it until the second
inlet receives a high signal \, at which point it resets its running
total;
#X text 245 389 improved samphold~ to work on signal level control
;
#X obj 45 297 inlet~;
#X obj 44 534 outlet~;
#X obj 453 198 inlet;
#X connect 3 0 25 0;
#X connect 3 0 24 1;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 8 0 4 0;
#X connect 12 0 14 0;
#X connect 14 0 15 0;
#X connect 14 1 16 0;
#X connect 15 0 13 0;
#X connect 16 0 13 1;
#X connect 18 0 19 0;
#X connect 19 0 8 1;
#X connect 21 0 24 0;
#X connect 22 0 30 0;
#X connect 24 0 22 0;
#X connect 25 0 21 1;
#X connect 29 0 21 0;
#X connect 29 0 21 2;
#X connect 31 0 8 0;
#X connect 31 0 10 0;
#X connect 31 0 22 1;
#X connect 31 0 5 1;
